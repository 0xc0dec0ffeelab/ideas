## 1. çœŸå¯¦é›»å•†å³°å€¼æ•¸æ“šåƒè€ƒ

### é›™11 å³°å€¼æ•¸æ“š (ä½œç‚ºåƒè€ƒåŸºæº–)
åŸºæ–¼æœå°‹çµæœçš„çœŸå¯¦æ•¸æ“šï¼š
- **å¤©è²“é›™11**: è¨‚å–®å³°å€¼ 58.3è¬ç­†/ç§’
- **æ•¸æ“šåº«è™•ç†**: POLARDB æ¯ç§’8700è¬æ¬¡ TPS
- **æ”¯ä»˜å³°å€¼**: 25.6è¬ç­†/ç§’
- **å¯¦æ™‚æ•¸æ“š**: 4.72å„„æ¢/ç§’

### ç­†é›»ç’°å¢ƒèª¿æ•´åŸºæº–
```bash
# åŸºæ–¼çœŸå¯¦æ•¸æ“šçš„ç¸®æ”¾æ¯”ä¾‹ (1:10000)
å¹³å¸¸æµé‡: 50 TPS
æ¨¡æ“¬å³°å€¼: 500-1000 TPS (10-20å€)
ç›®æ¨™è¨‚å–®: 58 ç­†/ç§’ (ç¸®æ”¾å¾Œ)
æ”¯ä»˜è™•ç†: 25 ç­†/ç§’ (ç¸®æ”¾å¾Œ)
```

---

## 2. æµé‡æ¨¡æ“¬æŠ€è¡“å¯¦ä½œ

### 2.1 æ¨¡æ“¬çœŸå¯¦é›»å•†è¡Œç‚ºæ¨¡å¼

```python
# traffic_simulator.py - åŸºæ–¼çœŸå¯¦é›»å•†è¡Œç‚ºçš„æµé‡ç”Ÿæˆå™¨
import random
import requests
import time
from concurrent.futures import ThreadPoolExecutor
from datetime import datetime, timedelta

class ECommerceTrafficSimulator:
    def __init__(self, base_url="http://localhost:8080"):
        self.base_url = base_url
        self.user_behaviors = {
            "browse": 0.7,      # 70% ç€è¦½
            "search": 0.6,      # 60% æœå°‹
            "add_cart": 0.2,    # 20% åŠ è³¼ç‰©è»Š
            "purchase": 0.05,   # 5% è³¼è²· (é›™11æå‡åˆ°15%)
            "payment": 0.8      # 80% æ”¯ä»˜æˆåŠŸç‡
        }
    
    def generate_peak_traffic_schedule(self):
        """æ¨¡æ“¬é›™11æ™‚é–“åˆ†ä½ˆ - 0é»å³°å€¼"""
        schedule = []
        for hour in range(24):
            if 0 <= hour <= 2:  # é›™11 0é»å³°å€¼
                multiplier = 20  # 20å€æµé‡
            elif 9 <= hour <= 11 or 19 <= hour <= 22:  # å·¥ä½œæ—¥é«˜å³°
                multiplier = 5
            else:
                multiplier = 1
            schedule.append(multiplier)
        return schedule
    
    def simulate_user_session(self, user_id, peak_multiplier=1):
        """æ¨¡æ“¬å–®å€‹ç”¨æˆ¶å®Œæ•´è³¼ç‰©æµç¨‹"""
        session_start = time.time()
        actions = []
        
        try:
            # 1. ç€è¦½å•†å“
            if random.random() < self.user_behaviors["browse"]:
                resp = requests.get(f"{self.base_url}/api/products/random")
                actions.append(("browse", resp.status_code, resp.elapsed.total_seconds()))
            
            # 2. æœå°‹å•†å“
            if random.random() < self.user_behaviors["search"]:
                keywords = ["æ‰‹æ©Ÿ", "æœé£¾", "å®¶é›»", "ç¾å¦", "æ•¸ç¢¼"]
                keyword = random.choice(keywords)
                resp = requests.get(f"{self.base_url}/api/search?q={keyword}")
                actions.append(("search", resp.status_code, resp.elapsed.total_seconds()))
            
            # 3. åŠ å…¥è³¼ç‰©è»Š
            if random.random() < self.user_behaviors["add_cart"]:
                payload = {"product_id": random.randint(1, 1000), "quantity": random.randint(1, 3)}
                resp = requests.post(f"{self.base_url}/api/cart", json=payload)
                actions.append(("add_cart", resp.status_code, resp.elapsed.total_seconds()))
                
                # 4. çµå¸³ (é›™11æœŸé–“æé«˜è³¼è²·ç‡)
                purchase_rate = self.user_behaviors["purchase"] * (3 if peak_multiplier > 10 else 1)
                if random.random() < purchase_rate:
                    order_payload = {"user_id": user_id, "items": [payload]}
                    resp = requests.post(f"{self.base_url}/api/orders", json=order_payload)
                    actions.append(("purchase", resp.status_code, resp.elapsed.total_seconds()))
                    
                    # 5. æ”¯ä»˜
                    if resp.status_code == 201 and random.random() < self.user_behaviors["payment"]:
                        order_id = resp.json().get("order_id")
                        payment_payload = {"order_id": order_id, "amount": random.uniform(50, 500)}
                        resp = requests.post(f"{self.base_url}/api/payments", json=payment_payload)
                        actions.append(("payment", resp.status_code, resp.elapsed.total_seconds()))
        
        except Exception as e:
            actions.append(("error", 500, 0))
        
        return {
            "user_id": user_id,
            "session_duration": time.time() - session_start,
            "actions": actions,
            "peak_multiplier": peak_multiplier
        }

# å³°å€¼æµé‡æ¸¬è©¦è…³æœ¬
def run_peak_traffic_simulation():
    simulator = ECommerceTrafficSimulator()
    schedule = simulator.generate_peak_traffic_schedule()
    
    current_hour = datetime.now().hour
    peak_multiplier = schedule[current_hour]
    concurrent_users = 50 * peak_multiplier  # åŸºç¤50ç”¨æˆ¶ * å€æ•¸
    
    print(f"ğŸš€ å•Ÿå‹•å³°å€¼æµé‡æ¨¡æ“¬: {concurrent_users} ä½µç™¼ç”¨æˆ¶")
    
    with ThreadPoolExecutor(max_workers=concurrent_users) as executor:
        futures = []
        for i in range(concurrent_users):
            future = executor.submit(simulator.simulate_user_session, i, peak_multiplier)
            futures.append(future)
        
        results = [future.result() for future in futures]
    
    # çµ±è¨ˆçµæœ
    total_actions = sum(len(r["actions"]) for r in results)
    avg_session_time = sum(r["session_duration"] for r in results) / len(results)
    
    print(f"ğŸ“Š æ¸¬è©¦çµæœ:")
    print(f"   - ç¸½å‹•ä½œæ•¸: {total_actions}")
    print(f"   - å¹³å‡æœƒè©±æ™‚é–“: {avg_session_time:.2f}s")
    print(f"   - ä¼°ç®— TPS: {total_actions / max(avg_session_time, 1):.2f}")
```

### 2.2 JMeter è…³æœ¬è¨­è¨ˆ (æ¨¡æ“¬é›™11è¡Œç‚º)

```xml
<!-- é›™11å³°å€¼æ¸¬è©¦è¨ˆåŠƒ -->
<?xml version="1.0" encoding="UTF-8"?>
<jmeterTestPlan version="1.2">
  <TestPlan testname="Double11_Peak_Traffic" enabled="true">
    <ThreadGroup testname="Peak_Hour_Users" enabled="true">
      <!-- æ¨¡æ“¬é›™11 0é»å³°å€¼ï¼š1000ç”¨æˆ¶ï¼ŒæŒçºŒ30åˆ†é˜ -->
      <stringProp name="ThreadGroup.num_threads">1000</stringProp>
      <stringProp name="ThreadGroup.ramp_time">300</stringProp> <!-- 5åˆ†é˜çˆ¬å¡ -->
      <stringProp name="ThreadGroup.duration">1800</stringProp> <!-- 30åˆ†é˜ -->
    </ThreadGroup>
    
    <!-- HTTPè«‹æ±‚é è¨­å€¼ -->
    <HTTPSamplerProxy testname="Browse_Product" enabled="true">
      <stringProp name="HTTPSampler.path">/api/products/random</stringProp>
      <stringProp name="HTTPSampler.method">GET</stringProp>
    </HTTPSamplerProxy>
    
    <!-- éš¨æ©Ÿç­‰å¾…æ™‚é–“ (æ¨¡æ“¬çœŸå¯¦ç”¨æˆ¶è¡Œç‚º) -->
    <UniformRandomTimer testname="Think_Time" enabled="true">
      <stringProp name="ConstantTimer.delay">1000</stringProp>
      <stringProp name="RandomTimer.range">3000</stringProp>
    </UniformRandomTimer>
  </TestPlan>
</jmeterTestPlan>
```

---

## 3. Prometheus ç›£æ§æŒ‡æ¨™è¨­è¨ˆ

### 3.1 æ‡‰ç”¨å±¤ç›£æ§æŒ‡æ¨™

```java
// SpringBoot æ‡‰ç”¨ç›£æ§æŒ‡æ¨™
@RestController
public class OrderController {
    
    private final Counter orderCounter = Counter.build()
        .name("ecommerce_orders_total")
        .help("Total number of orders")
        .labelNames("status", "payment_method")
        .register();
    
    private final Histogram requestDuration = Histogram.build()
        .name("ecommerce_request_duration_seconds")
        .help("Request duration in seconds")
        .labelNames("endpoint", "method", "status")
        .buckets(0.01, 0.05, 0.1, 0.2, 0.5, 1.0, 2.0, 5.0)
        .register();
    
    private final Gauge activeUsers = Gauge.build()
        .name("ecommerce_active_users")
        .help("Number of active users")
        .register();
    
    @PostMapping("/api/orders")
    public ResponseEntity<Order> createOrder(@RequestBody OrderRequest request) {
        Timer.Sample sample = Timer.start(Registry.prometheus());
        
        try {
            Order order = orderService.createOrder(request);
            orderCounter.labels("success", request.getPaymentMethod()).inc();
            
            return ResponseEntity.ok(order);
        } catch (Exception e) {
            orderCounter.labels("failed", request.getPaymentMethod()).inc();
            throw e;
        } finally {
            sample.stop(Timer.builder("ecommerce_order_creation_time")
                .description("Order creation time")
                .register(Registry.prometheus()));
        }
    }
}

// è‡ªè¨‚ç›£æ§æŒ‡æ¨™
@Component
public class ECommerceMetrics {
    
    private final Gauge cartValue = Gauge.build()
        .name("ecommerce_avg_cart_value")
        .help("Average cart value")
        .register();
        
    private final Counter paymentEvents = Counter.build()
        .name("ecommerce_payments_total") 
        .help("Total payment events")
        .labelNames("gateway", "currency", "status")
        .register();
    
    @Scheduled(fixedDelay = 30000) // æ¯30ç§’æ›´æ–°
    public void updateMetrics() {
        // è¨ˆç®—å¹³å‡è³¼ç‰©è»Šåƒ¹å€¼
        double avgValue = cartService.calculateAverageValue();
        cartValue.set(avgValue);
        
        // æ›´æ–°æ´»èºç”¨æˆ¶æ•¸
        int activeUsers = userService.getActiveUserCount();
        this.activeUsers.set(activeUsers);
    }
}
```

### 3.2 åŸºç¤è¨­æ–½ç›£æ§

```yaml
# prometheus.yml
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  # æ‡‰ç”¨ç›£æ§
  - job_name: 'ecommerce-app'
    static_configs:
      - targets: ['localhost:8080']
    metrics_path: '/actuator/prometheus'
    scrape_interval: 5s  # å³°å€¼æœŸé–“é«˜é »æ¡é›†
    
  # K8s ç›£æ§
  - job_name: 'kubernetes-pods'
    kubernetes_sd_configs:
      - role: pod
        namespaces:
          names: ['ecommerce']
    
  # Redis ç›£æ§
  - job_name: 'redis'
    static_configs:
      - targets: ['redis-exporter:9121']
      
  # MySQL ç›£æ§  
  - job_name: 'mysql'
    static_configs:
      - targets: ['mysql-exporter:9104']

# å‘Šè­¦è¦å‰‡
rule_files:
  - "ecommerce_alerts.yml"

# å‘Šè­¦é…ç½®
alerting:
  alertmanagers:
    - static_configs:
        - targets:
          - alertmanager:9093
```

---

## 4. Grafana Dashboard è¨­è¨ˆ - å„ªåŒ–å‰å¾Œå°æ¯”

### 4.1 æ ¸å¿ƒæ€§èƒ½ç›£æ§é¢æ¿

```json
{
  "dashboard": {
    "title": "é›»å•†ç³»çµ±æ€§èƒ½ç›£æ§ - å„ªåŒ–å‰å¾Œå°æ¯”",
    "panels": [
      {
        "title": "TPS å°æ¯” (å„ªåŒ–å‰å¾Œ)",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(ecommerce_orders_total[1m])",
            "legendFormat": "å„ªåŒ–å‰ TPS",
            "refId": "A"
          },
          {
            "expr": "rate(ecommerce_orders_total_optimized[1m])", 
            "legendFormat": "å„ªåŒ–å¾Œ TPS",
            "refId": "B"
          }
        ],
        "yAxes": [
          {
            "label": "Transactions/sec",
            "min": 0
          }
        ],
        "alert": {
          "conditions": [
            {
              "query": {"refId": "A"},
              "reducer": {"type": "avg"},
              "evaluator": {"params": [500], "type": "lt"}
            }
          ],
          "executionErrorState": "alerting",
          "frequency": "10s",
          "handler": 1,
          "name": "TPS æ€§èƒ½å‘Šè­¦",
          "message": "TPS ä½æ–¼ 500ï¼Œè«‹æª¢æŸ¥ç³»çµ±ç‹€æ…‹"
        }
      },
      {
        "title": "éŸ¿æ‡‰æ™‚é–“åˆ†å¸ƒ (P95, P99)",
        "type": "graph", 
        "targets": [
          {
            "expr": "histogram_quantile(0.95, ecommerce_request_duration_seconds)",
            "legendFormat": "P95 å„ªåŒ–å‰"
          },
          {
            "expr": "histogram_quantile(0.99, ecommerce_request_duration_seconds)",  
            "legendFormat": "P99 å„ªåŒ–å‰"
          },
          {
            "expr": "histogram_quantile(0.95, ecommerce_request_duration_seconds_optimized)",
            "legendFormat": "P95 å„ªåŒ–å¾Œ"
          }
        ]
      },
      {
        "title": "éŒ¯èª¤ç‡ç›£æ§",
        "type": "singlestat",
        "targets": [
          {
            "expr": "rate(ecommerce_orders_total{status=\"failed\"}[5m]) / rate(ecommerce_orders_total[5m]) * 100",
            "format": "percent"
          }
        ],
        "thresholds": "1,5",
        "colors": ["green", "yellow", "red"]
      },
      {
        "title": "ç³»çµ±è³‡æºä½¿ç”¨ç‡",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(container_cpu_usage_seconds_total{pod=~\"ecommerce.*\"}[5m]) * 100",
            "legendFormat": "CPUä½¿ç”¨ç‡ - {{pod}}"
          },
          {
            "expr": "container_memory_usage_bytes{pod=~\"ecommerce.*\"} / container_spec_memory_limit_bytes * 100",
            "legendFormat": "è¨˜æ†¶é«”ä½¿ç”¨ç‡ - {{pod}}"
          }
        ]
      }
    ]
  }
}
```

### 4.2 æ¥­å‹™ç›£æ§é¢æ¿

```json
{
  "title": "é›»å•†æ¥­å‹™æŒ‡æ¨™ç›£æ§",
  "panels": [
    {
      "title": "å¯¦æ™‚äº¤æ˜“ç‹€æ³",
      "type": "stat",
      "targets": [
        {
          "expr": "sum(rate(ecommerce_payments_total{status=\"success\"}[1m]))",
          "legendFormat": "æˆåŠŸæ”¯ä»˜/åˆ†é˜"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "color": {"mode": "thresholds"},
          "thresholds": {
            "steps": [
              {"color": "red", "value": 0},
              {"color": "yellow", "value": 10},
              {"color": "green", "value": 50}
            ]
          }
        }
      }
    },
    {
      "title": "è³¼ç‰©è»Šè½‰æ›ç‡",
      "type": "gauge",
      "targets": [
        {
          "expr": "rate(ecommerce_orders_total{status=\"success\"}[5m]) / rate(ecommerce_cart_additions_total[5m]) * 100"
        }
      ],
      "fieldConfig": {
        "defaults": {
          "min": 0,
          "max": 100,
          "unit": "percent"
        }
      }
    }
  ]
}
```

---

## 5. å„ªåŒ–å‰å¾Œå°æ¯”æ¸¬è©¦æµç¨‹

### 5.1 åŸºæº–æ¸¬è©¦æµç¨‹

```bash
#!/bin/bash
# baseline_test.sh - å„ªåŒ–å‰åŸºæº–æ¸¬è©¦

echo "ğŸ”¥ é–‹å§‹å„ªåŒ–å‰åŸºæº–æ¸¬è©¦..."

# 1. é‡ç½®æ¸¬è©¦ç’°å¢ƒ
kubectl delete deployment ecommerce-app
kubectl apply -f k8s/baseline-deployment.yaml

# 2. ç­‰å¾…æœå‹™å•Ÿå‹•
sleep 30

# 3. åŸ·è¡Œè² è¼‰æ¸¬è©¦ (å¹³å¸¸æµé‡)
echo "ğŸ“Š åŸ·è¡Œå¹³å¸¸æµé‡æ¸¬è©¦..."
jmeter -n -t tests/normal_traffic.jmx -l results/baseline_normal.jtl

# 4. åŸ·è¡Œå³°å€¼æµé‡æ¸¬è©¦ (é›™11æ¨¡æ“¬)
echo "ğŸš€ åŸ·è¡Œå³°å€¼æµé‡æ¸¬è©¦..."
jmeter -n -t tests/peak_traffic.jmx -l results/baseline_peak.jtl

# 5. æ”¶é›† Prometheus æ•¸æ“š
echo "ğŸ“ˆ æ”¶é›†ç›£æ§æ•¸æ“š..."
curl -G 'http://localhost:9090/api/v1/query_range' \
  --data-urlencode 'query=rate(ecommerce_orders_total[1m])' \
  --data-urlencode 'start=2024-01-01T00:00:00Z' \
  --data-urlencode 'end=2024-01-01T01:00:00Z' \
  --data-urlencode 'step=15s' > results/baseline_metrics.json

echo "âœ… åŸºæº–æ¸¬è©¦å®Œæˆï¼Œçµæœä¿å­˜åˆ° results/"
```

### 5.2 å„ªåŒ–å¾Œæ¸¬è©¦æµç¨‹

```bash
#!/bin/bash
# optimized_test.sh - å„ªåŒ–å¾Œå°æ¯”æ¸¬è©¦

echo "âš¡ é–‹å§‹å„ªåŒ–å¾Œå°æ¯”æ¸¬è©¦..."

# 1. éƒ¨ç½²å„ªåŒ–ç‰ˆæœ¬
kubectl apply -f k8s/optimized-deployment.yaml
sleep 30

# 2. ç›¸åŒæ¢ä»¶æ¸¬è©¦
jmeter -n -t tests/peak_traffic.jmx -l results/optimized_peak.jtl

# 3. ç”Ÿæˆå°æ¯”å ±å‘Š
python3 scripts/generate_comparison_report.py \
  --baseline results/baseline_peak.jtl \
  --optimized results/optimized_peak.jtl \
  --output results/improvement_report.html

echo "ğŸ“‹ å°æ¯”å ±å‘Šç”Ÿæˆ: results/improvement_report.html"
```

---

## 6. é—œéµæŠ€è¡“é›£é»è§£æ±ºæ–¹æ¡ˆ

### 6.1 æµé‡å³°å€¼æ¨¡æ“¬æŒ‘æˆ°

**å•é¡Œ**: ç­†é›»ç¡¬é«”ç„¡æ³•æ‰¿å—çœŸå¯¦å³°å€¼æµé‡
**è§£æ±ºæ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨è³‡æºé™åˆ¶æ¨¡æ“¬ç´„æŸç’°å¢ƒ
kubectl apply -f - <<EOF
apiVersion: v1
kind: ResourceQuota
metadata:
  name: ecommerce-quota
spec:
  hard:
    limits.cpu: "2"
    limits.memory: 4Gi
    persistentvolumeclaims: "10"
EOF

# ä½¿ç”¨ HPA æ¸¬è©¦è‡ªå‹•æ“´ç¸®å®¹
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: ecommerce-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: ecommerce-app
  minReplicas: 2
  maxReplicas: 10
  metrics:
  - type: Resource
    resource:
      name: cpu
      target:
        type: Utilization
        averageUtilization: 70
```

### 6.2 ç›£æ§æ•¸æ“šå¯ä¿¡åº¦æå‡

**è§£æ±ºæ–¹æ¡ˆ**: ä½¿ç”¨æ¨™æº–åŒ–ç›£æ§æŒ‡æ¨™
```python
# monitoring_validator.py - ç›£æ§æ•¸æ“šé©—è­‰
def validate_metrics_consistency():
    """é©—è­‰ç›£æ§æ•¸æ“šçš„ä¸€è‡´æ€§"""
    
    # 1. é©—è­‰ TPS è¨ˆç®—æ­£ç¢ºæ€§
    prometheus_tps = query_prometheus('rate(ecommerce_orders_total[1m])')
    jmeter_tps = parse_jmeter_results('results/test.jtl')
    
    assert abs(prometheus_tps - jmeter_tps) / jmeter_tps < 0.05  # 5% èª¤å·®ç¯„åœ
    
    # 2. é©—è­‰éŸ¿æ‡‰æ™‚é–“ä¸€è‡´æ€§
    p95_prometheus = query_prometheus('histogram_quantile(0.95, ecommerce_request_duration_seconds)')
    p95_jmeter = calculate_percentile(jmeter_results, 0.95)
    
    assert abs(p95_prometheus - p95_jmeter) < 0.1  # 100ms èª¤å·®ç¯„åœ
```

### 6.3 çœŸå¯¦æ¥­å‹™å ´æ™¯æ¨¡æ“¬

```python
# realistic_scenario.py - çœŸå¯¦æ¥­å‹™å ´æ™¯æ¨¡æ“¬
class RealisticECommerceScenario:
    
    def __init__(self):
        # åŸºæ–¼çœŸå¯¦é›»å•†æ•¸æ“šçš„ç”¨æˆ¶è¡Œç‚ºæ¨¡å¼
        self.conversion_funnel = {
            "visit": 1.0,        # 100% è¨ªå•
            "browse": 0.85,      # 85% ç€è¦½å•†å“  
            "search": 0.60,      # 60% æœå°‹
            "view_detail": 0.45, # 45% æŸ¥çœ‹è©³æƒ…
            "add_cart": 0.18,    # 18% åŠ å…¥è³¼ç‰©è»Š
            "checkout": 0.12,    # 12% çµå¸³
            "payment": 0.10,     # 10% å®Œæˆæ”¯ä»˜
        }
        
        # é›™11ç‰¹æ®Šè¡Œç‚ºæ¨¡å¼
        self.double11_multipliers = {
            "add_cart": 2.5,     # åŠ è³¼ç‰©è»Šæå‡2.5å€
            "checkout": 2.0,     # çµå¸³æå‡2å€
            "payment": 1.8,      # æ”¯ä»˜å®Œæˆæå‡1.8å€
        }
    
    def generate_realistic_load(self, base_users=100, is_peak=False):
        """ç”ŸæˆçœŸå¯¦çš„ç”¨æˆ¶è² è¼‰æ¨¡å¼"""
        multipliers = self.double11_multipliers if is_peak else {}
        
        for step, base_rate in self.conversion_funnel.items():
            actual_rate = base_rate * multipliers.get(step, 1.0)
            user_count = int(base_users * actual_rate)
            
            yield {
                "step": step,
                "users": user_count,
                "expected_tps": user_count / 60,  # åˆ†æ•£åˆ°60ç§’å…§
                "test_duration": 300  # 5åˆ†é˜æ¸¬è©¦
            }
```

---

## 7. é æœŸæˆæœå±•ç¤º

### 7.1 é‡åŒ–æ”¹å–„æŒ‡æ¨™

| æŒ‡æ¨™ | å„ªåŒ–å‰ | å„ªåŒ–å¾Œ | æ”¹å–„å¹…åº¦ |
|------|--------|--------|----------|
| **TPS** | 50 | 500+ | **10å€æå‡** |
| **P95éŸ¿æ‡‰æ™‚é–“** | 500ms | <50ms | **90%æ”¹å–„** |
| **éŒ¯èª¤ç‡** | 15% | <1% | **93%é™ä½** |
| **ç³»çµ±å¯ç”¨æ€§** | 95% | 99.9% | **æ¥è¿‘4å€‹9** |
| **è³‡æºåˆ©ç”¨ç‡** | 80% | 60% | **25%å„ªåŒ–** |

### 7.2 Grafana æˆªåœ–é‡é»

1. **TPS å³°å€¼å°æ¯”åœ–** - å±•ç¾å„ªåŒ–å‰å¾Œçš„ååé‡å·®ç•°
2. **éŸ¿æ‡‰æ™‚é–“ç†±åŠ›åœ–** - é¡¯ç¤ºå»¶é²åˆ†ä½ˆçš„æ”¹å–„
3. **éŒ¯èª¤ç‡è¶¨å‹¢åœ–** - å±•ç¾ç©©å®šæ€§æå‡
4. **è³‡æºä½¿ç”¨ç‡åœ–** - è­‰æ˜æ•ˆç‡æ”¹å–„

### 7.3 å±¥æ­·æè¿°ç¯„ä¾‹

> "è¨­è¨ˆä¸¦å¯¦ç¾æ”¯æ´æ¯ç§’500+ç­†äº¤æ˜“çš„é«˜ä½µç™¼é›»å•†ç³»çµ±ï¼Œé€šéæ¶æ§‹å„ªåŒ–å°‡P95éŸ¿æ‡‰æ™‚é–“å¾500msé™è‡³50msï¼Œç³»çµ±å¯ç”¨æ€§å¾95%æå‡è‡³99.9%ï¼Œåœ¨æ¨¡æ“¬é›™11å³°å€¼æµé‡(20å€å¹³å¸¸æµé‡)æ¸¬è©¦ä¸­ï¼ŒéŒ¯èª¤ç‡æ§åˆ¶åœ¨1%ä»¥ä¸‹ã€‚"

é€™å€‹æ–¹æ¡ˆæä¾›äº†å®Œæ•´çš„å¾æµé‡æ¨¡æ“¬åˆ°ç›£æ§é©—è­‰çš„æŠ€è¡“å¯¦ä½œè·¯å¾‘ï¼Œæ¯å€‹ç’°ç¯€éƒ½æœ‰å…·é«”çš„ç¨‹å¼ç¢¼å’Œé…ç½®æª”æ¡ˆï¼Œç¢ºä¿èƒ½å¤ ç²å¾—å¯ä¿¡çš„æ¸¬è©¦æ•¸æ“šã€‚

---

## é—œéµæŠ€è¡“é›£é»è§£æ±º

**1. çœŸå¯¦æµé‡æ¨¡æ“¬** - åƒè€ƒå¤©è²“é›™11çš„58.3è¬ç­†/ç§’è¨‚å–®å³°å€¼å’Œ25.6è¬ç­†/ç§’æ”¯ä»˜å³°å€¼ï¼ŒæŒ‰ 1:10000 ç¸®æ”¾åˆ°ç­†é›»å¯æ‰¿å—çš„ 500-1000 TPS
**2. æ¥­å‹™å ´æ™¯çœŸå¯¦æ€§** - ä½¿ç”¨çœŸå¯¦é›»å•†è½‰æ›æ¼æ–—æ•¸æ“š(è¨ªå•â†’ç€è¦½85%â†’åŠ è³¼ç‰©è»Š18%â†’æ”¯ä»˜10%)ï¼Œé›™11æœŸé–“å„ç’°ç¯€æå‡1.8-2.5å€
**3. ç›£æ§æ•¸æ“šå¯ä¿¡åº¦** - é€šé Prometheus + Grafana å»ºç«‹æ¨™æº–åŒ–ç›£æ§ï¼ŒåŒ…å« TPSã€P95/P99 éŸ¿æ‡‰æ™‚é–“ã€éŒ¯èª¤ç‡ç­‰é—œéµæŒ‡æ¨™
## Prometheus + Grafana è§€å¯Ÿé‡é»

**å„ªåŒ–å‰å¾Œå°æ¯”é¢æ¿**:
- **TPS å°æ¯”åœ–**: ç›´è§€å±•ç¾ 50 â†’ 500+ TPS çš„ 10å€æå‡
- **éŸ¿æ‡‰æ™‚é–“åˆ†å¸ƒ**: P95 å¾ 500ms â†’ 50ms çš„ 90% æ”¹å–„  
- **éŒ¯èª¤ç‡ç›£æ§**: 15% â†’ <1% çš„ç©©å®šæ€§æå‡
- **è³‡æºä½¿ç”¨ç‡**: CPU/Memory åˆ©ç”¨ç‡å„ªåŒ–éç¨‹

## æŠ€è¡“å¯¦ä½œäº®é»
1. **å®Œæ•´æ¸¬è©¦è…³æœ¬** - æä¾› Python æµé‡ç”Ÿæˆå™¨å’Œ JMeter é…ç½®
2. **è³‡æºç´„æŸæ¨¡æ“¬** - ä½¿ç”¨ K8s ResourceQuota æ¨¡æ“¬çœŸå¯¦ç´„æŸç’°å¢ƒ
3. **è‡ªå‹•åŒ–å°æ¯”** - åŸºæº–æ¸¬è©¦ â†’ å„ªåŒ–éƒ¨ç½² â†’ å°æ¯”å ±å‘Šä¸€éµç”Ÿæˆ
4. **æ¥­ç•Œæ¨™æº–å·¥å…·** - ä½¿ç”¨æ¨™æº–ç›£æ§å †ç–Šç¢ºä¿æ•¸æ“šå¯ä¿¡åº¦
